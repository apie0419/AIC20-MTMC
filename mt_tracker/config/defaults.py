from yacs.config import CfgNode as CN
import os

BASE_PATH = os.path.dirname(os.path.abspath(__file__))

_C = CN()
_C.PATH = CN()
_C.MODEL = CN()
_C.DATASETS = CN()
_C.SOLVER = CN()
_C.DATALOADER = CN()
_C.INPUT = CN()

_C.PATH.ROOT_PATH = '<path_project_dir>'
_C.PATH.INPUT_PATH = '<path_to_input_path>' # train or test

_C.MODEL.CUDA = 1 # gpu number
_C.MODEL.DEVICE = "<cuda or cpu>"
_C.MODEL.OUTPUT_DIR = "<save train weight path>"
_C.MODEL.NAME = "<model name>"
_C.MODEL.APPEARANCE_DIM = 128 # appearance featrue size
_C.MODEL.PHYSIC_DIM = 128 # physic feature size

_C.MODEL.TEST_MODEL = "<test model path>"


_C.DATASETS.NAME = "<dataset name>"

_C.DATALOADER.NUM_WORKERS = 8
_C.DATALOADER.NUM_INSTANCE = 4

_C.TEST = CN()
_C.TEST.IMS_PER_BATCH = 128

_C.SOLVER.OPTIMIZER_NAME = "Adam"

_C.SOLVER.MAX_EPOCHS = 50
_C.SOLVER.IMS_PER_BATCH = 128

_C.SOLVER.BASE_LR = 3e-4
_C.SOLVER.BIAS_LR_FACTOR = 2
_C.SOLVER.MOMENTUM = 0.9
_C.SOLVER.MARGIN = 0.3

_C.SOLVER.WEIGHT_DECAY = 0.0005
_C.SOLVER.WEIGHT_DECAY_BIAS = 0.0005

_C.SOLVER.GAMMA = 0.1
_C.SOLVER.STEPS = (30, 55)

_C.SOLVER.WARMUP_FACTOR = 1.0 / 3
_C.SOLVER.WARMUP_ITERS = 500
_C.SOLVER.WARMUP_METHOD = "linear"

_C.SOLVER.CHECKPOINT_PERIOD = 50
_C.SOLVER.LOG_PERIOD = 100
_C.SOLVER.EVAL_PERIOD = 50

_C.INPUT.TS_STD = [38.03783, 38.19534]
_C.INPUT.TS_MEAN = [27.26076, 25.96027]
_C.INPUT.GPS_STD = [0.00013765, 0.00013720, 0.00057203]
_C.INPUT.GPS_MEAN = [0.000005636, 0.000005611, 0.000002973]
_C.INPUT.TS_MIN = [0.000, 0.000]
_C.INPUT.TS_MAX = [208.0, 205.0]
_C.INPUT.GPS_MIN = [0.000, 0.000, 0.000]
_C.INPUT.GPS_MAX = [0.000905503, 0.000890009, 0.016692804]

_C.merge_from_file(os.path.join(BASE_PATH, "config.yaml"))
_C.freeze()